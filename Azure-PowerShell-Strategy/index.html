<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Azure PowerShell Strategy | AaRoney&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Introduction Investment Areas Compete Azure PowerShell Azure CLI 2.0 GCloud AWS Heroku Zeit Now   Proposed Areas of Improvement Core Improvements Scenario-based Cmdlets Experimental Improvements O">
<meta property="og:type" content="website">
<meta property="og:title" content="Azure PowerShell Strategy">
<meta property="og:url" content="http://blog.aaroney.com/Azure-PowerShell-Strategy/index.html">
<meta property="og:site_name" content="AaRoney&#39;s Blog">
<meta property="og:description" content="Introduction Investment Areas Compete Azure PowerShell Azure CLI 2.0 GCloud AWS Heroku Zeit Now   Proposed Areas of Improvement Core Improvements Scenario-based Cmdlets Experimental Improvements O">
<meta property="og:locale" content="default">
<meta property="og:image" content="http://blog.aaroney.com/Azure-PowerShell-Strategy/index/PS_Experiment_Discussion.jpg">
<meta property="og:updated_time" content="2017-07-24T05:43:44.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Azure PowerShell Strategy">
<meta name="twitter:description" content="Introduction Investment Areas Compete Azure PowerShell Azure CLI 2.0 GCloud AWS Heroku Zeit Now   Proposed Areas of Improvement Core Improvements Scenario-based Cmdlets Experimental Improvements O">
<meta name="twitter:image" content="http://blog.aaroney.com/Azure-PowerShell-Strategy/index/PS_Experiment_Discussion.jpg">
<meta name="twitter:creator" content="@twitchax">
  
    <link rel="alternate" href="/atom.xml" title="AaRoney&#39;s Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-91476707-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">AaRoney&#39;s Blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://blog.aaroney.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="page-" class="article article-type-page" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/Azure-PowerShell-Strategy/index.html" class="article-date">
  <time datetime="2017-05-15T04:52:13.000Z" itemprop="datePublished">2017-05-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Azure PowerShell Strategy
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <div class="toc">

<!-- toc -->
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#investment-areas">Investment Areas</a></li>
<li><a href="#compete">Compete</a><ul>
<li><a href="#azure-powershell">Azure PowerShell</a></li>
<li><a href="#azure-cli-20">Azure CLI 2.0</a></li>
<li><a href="#gcloud">GCloud</a></li>
<li><a href="#aws">AWS</a></li>
<li><a href="#heroku">Heroku</a></li>
<li><a href="#zeit-now">Zeit Now</a></li>
</ul>
</li>
<li><a href="#proposed-areas-of-improvement">Proposed Areas of Improvement</a><ul>
<li><a href="#core-improvements">Core Improvements</a></li>
<li><a href="#scenario-based-cmdlets">Scenario-based Cmdlets</a></li>
<li><a href="#experimental-improvements">Experimental Improvements</a></li>
<li><a href="#other">Other</a></li>
</ul>
</li>
<li><a href="#killer-demos">Killer Demos</a><ul>
<li><a href="#create-vm">Create VM</a></li>
<li><a href="#create-and-deploy-web-app">Create and Deploy Web App</a></li>
<li><a href="#storage-scenarios">Storage scenarios?</a></li>
<li><a href="#sql-scenarios">SQL scenarios?</a></li>
<li><a href="#network-scenarios">Network scenarios?</a></li>
<li><a href="#acsacrcontainer-scenarios">ACS/ACR/Container scenarios?</a></li>
<li><a href="#function-app-awesomeness">Function app awesomeness?</a></li>
</ul>
</li>
<li><a href="#customer-feedback">Customer Feedback</a><ul>
<li><a href="#concept-interviews">Concept Interviews</a></li>
<li><a href="#feature-interviews">Feature Interviews</a></li>
<li><a href="#hci-interviews">HCI Interviews</a></li>
</ul>
<ul>
<li><a href="#conclusion">Conclusion</a></li>
</ul>
</li>
</ul>
<!-- tocstop -->
</div>

<blockquote>
<p>What are killer demos for Azure PowerShell?  How do we get there?</p>
</blockquote>
<h2><span id="introduction">Introduction</span></h2><p>As the de facto standard for Azure automation scenarios, Azure PowerShell is ubiquitous in its penetration of the cloud market.  This penetration means that all services across Azure must provide their users with workable Azure PowerShell cmdlets.  Historically, Azure PowerShell was largely owned by a single team; however, over time, the model for Azure PowerShell has become a “hub and spoke”, where the Azure PowerShell feature team provides repositories, guidelines, static analysis, reviews, build tools, and publish tools, and service teams own the design and functionality of their cmdlets.  This model functions well, and it is within this model that Azure PowerShell successfully cemented itself as the de facto standard for Azure automation scenarios.</p>
<p>Through the years of this “hub and spoke” model, Azure PowerShell became, for all intents and purposes, a “mature” product.  We say this because most of the practices, guidelines, and processes have been in place and well-oiled for quite some time.  Its maturity has brought high usage and a solid customer base.  However, this maturity and stable complacency comes at a cost to investment in innovation.</p>
<p>Azure PowerShell has become somewhat of a “second thought” to service teams; however, the recent emphasis on Azure CLI 2.0 by management has led this team and others to re-evaluate the value of Azure PowerShell and its place in the each resource provider’s lifecycle.  It is with this renewed emphasis on developer tools (especially CLIs) in Azure that our team hopes to accomplish drastic improvements to the Azure PowerShell experience.  This document will view other cloud platforms and Azure CLI 2.0 itself as competitors in an effort to properly determine how Azure PowerShell stacks up with the innovations of other CLIs (both internal and external).</p>
<h2><span id="investment-areas">Investment Areas</span></h2><table>
<thead>
<tr>
<th>Investment</th>
<th>Goal</th>
<th>Scenarios</th>
<th>Priority</th>
<th>Cost Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>Cmdlet Modernization, Reduce Barrier to Entry</td>
<td>TBD</td>
<td>Shorten cmdlet and parameter names which will improve script readability and tab completion scenarios.</td>
<td>1</td>
<td>Dev</td>
</tr>
<tr>
<td></td>
<td></td>
<td>Improve smart defaults to enable users to work through scenarios (especially creation scenarios) with greater ease.  This includes product-wide defaults and environment-specific defaults.</td>
<td>0</td>
<td>Dev</td>
</tr>
<tr>
<td></td>
<td></td>
<td>Improve creation scenarios by redesigning cmdlets with common scenarios in mind.  This includes interactive experiences, directed experiences and lower overall barrier to entry via the aforementioned improvements.</td>
<td>1</td>
<td>PM, Dev</td>
</tr>
<tr>
<td></td>
<td></td>
<td>Improve utility by providing directed output for users.  That is, ensure users are aware of “common next steps” by providing output which directs users towards those common subsequent tasks.</td>
<td>2</td>
<td>PM, Dev</td>
</tr>
<tr>
<td></td>
<td></td>
<td>Approach consistency in the low complexity of scenarios by converging on a ”mostly shared” ARM template layer with Azure CLI.</td>
<td>1</td>
<td>PM, Dev</td>
</tr>
<tr>
<td>Ecosystem Support</td>
<td>TBD</td>
<td>Convert all of the AzureRM modules to PowerShell Core (via the Azure SDK for .NET Core).  This enables key scenarios which the PowerShell Core team is attempting to deliver, and allows for AzureRM usage on Mac/Linux.</td>
<td>0</td>
<td>Dev</td>
</tr>
<tr>
<td></td>
<td></td>
<td>Support Azure Stack scenarios with improvements to the Profile system.</td>
<td>1</td>
<td>Dev</td>
</tr>
<tr>
<td></td>
<td></td>
<td>Support the Consistent Cloud in Azure PowerShell Integration in Cloud Shell by providing improvements (such as .NET Core support) which ensure key scenarios in the browser.</td>
<td>1</td>
<td>Dev</td>
</tr>
<tr>
<td>Engineering Improvements</td>
<td>TBD</td>
<td>Improve documentation and samples, along with the planned product improvements, to empower users in their engineering efforts.</td>
<td>2</td>
<td>PM, Docs</td>
</tr>
<tr>
<td></td>
<td></td>
<td>Manage issues and improvements in GitHub by fixing or closing issues within a specified time period SLA.  We will first cleanup existing issues to achieve a well-known state.</td>
<td>1</td>
<td>PM, Management</td>
</tr>
<tr>
<td></td>
<td></td>
<td>Author reporting tools which supply common statistics (e.g., issue close rate, documentation quality, etc.) to partner teams.</td>
<td>2</td>
<td>PM, Dev</td>
</tr>
<tr>
<td>Awareness</td>
<td>TBD</td>
<td>Make telemetry improvements which will paint a consistent picture across Azure developer tools and drive meaningful insight into how our product changes impact our customers.</td>
<td>2</td>
<td>PM, Dev</td>
</tr>
<tr>
<td></td>
<td></td>
<td>Engage the community by publishing community standups, regular tutorial videos, and interviews with team members.</td>
<td>1</td>
<td>PM</td>
</tr>
</tbody>
</table>
<h2><span id="compete">Compete</span></h2><h3><span id="azure-powershell">Azure PowerShell</span></h3><p>Create VM.<a name="createVmOld"></a></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Variables for common values</span></span><br><span class="line">$ <span class="variable">$resourceGroup</span> = <span class="string">"myResourceGroup"</span></span><br><span class="line">$ <span class="variable">$location</span> = <span class="string">"westeurope"</span></span><br><span class="line">$ <span class="variable">$vmName</span> = <span class="string">"myVM"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Create user object</span></span><br><span class="line">$ <span class="variable">$cred</span> = <span class="built_in">Get-Credential</span> -Message <span class="string">"Enter a username and password for the virtual machine."</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Create a resource group</span></span><br><span class="line">$ New-AzureRmResourceGroup -Name <span class="variable">$resourceGroup</span> -Location <span class="variable">$location</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Create a subnet configuration</span></span><br><span class="line">$ <span class="variable">$subnetConfig</span> = New-AzureRmVirtualNetworkSubnetConfig -Name mySubnet -AddressPrefix <span class="number">192.168</span>.<span class="number">1.0</span>/<span class="number">24</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Create a virtual network</span></span><br><span class="line">$ <span class="variable">$vnet</span> = New-AzureRmVirtualNetwork -ResourceGroupName <span class="variable">$resourceGroup</span> -Location <span class="variable">$location</span> -Name MYvNET -AddressPrefix <span class="number">192.168</span>.<span class="number">0.0</span>/<span class="number">16</span> -Subnet <span class="variable">$subnetConfig</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Create a public IP address and specify a DNS name</span></span><br><span class="line">$ <span class="variable">$pip</span> = New-AzureRmPublicIpAddress -ResourceGroupName <span class="variable">$resourceGroup</span> -Location <span class="variable">$location</span> -Name <span class="string">"mypublicdns$(Get-Random)"</span> -AllocationMethod Static -IdleTimeoutInMinutes <span class="number">4</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Create an inbound network security group rule for port 3389</span></span><br><span class="line">$ <span class="variable">$nsgRuleRDP</span> = New-AzureRmNetworkSecurityRuleConfig -Name myNetworkSecurityGroupRuleRDP  -Protocol Tcp -Direction Inbound -Priority <span class="number">1000</span> -SourceAddressPrefix * -SourcePortRange * -DestinationAddressPrefix * -DestinationPortRange <span class="number">3389</span> -Access Allow</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create a network security group</span></span><br><span class="line">$ <span class="variable">$nsg</span> = New-AzureRmNetworkSecurityGroup -ResourceGroupName <span class="variable">$resourceGroup</span> -Location <span class="variable">$location</span> -Name myNetworkSecurityGroup -SecurityRules <span class="variable">$nsgRuleRDP</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Create a virtual network card and associate with public IP address and NSG</span></span><br><span class="line">$ <span class="variable">$nic</span> = New-AzureRmNetworkInterface -Name myNic -ResourceGroupName <span class="variable">$resourceGroup</span> -Location <span class="variable">$location</span> -SubnetId <span class="variable">$vnet</span>.Subnets[<span class="number">0</span>].Id -PublicIpAddressId <span class="variable">$pip</span>.Id -NetworkSecurityGroupId <span class="variable">$nsg</span>.Id</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create a virtual machine configuration</span></span><br><span class="line">$ <span class="variable">$vmConfig</span> = New-AzureRmVMConfig -VMName <span class="variable">$vmName</span> -VMSize Standard_D1 | Set-AzureRmVMOperatingSystem -Windows -ComputerName <span class="variable">$vmName</span> -Credential <span class="variable">$cred</span> | Set-AzureRmVMSourceImage -PublisherName MicrosoftWindowsServer -Offer WindowsServer -Skus <span class="number">2016</span>-Datacenter -Version latest | Add-AzureRmVMNetworkInterface -Id <span class="variable">$nic</span>.Id</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create a virtual machine</span></span><br><span class="line">$ New-AzureRmVM -ResourceGroupName <span class="variable">$resourceGroup</span> -Location <span class="variable">$location</span> -VM <span class="variable">$vmConfig</span></span><br></pre></td></tr></table></figure>
<p>Create and deploy web app.</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="variable">$gitdirectory</span>=<span class="string">"&lt;Replace with path to local Git repo&gt;"</span></span><br><span class="line">$ <span class="variable">$webappname</span>=<span class="string">"mywebapp$(Get-Random)"</span></span><br><span class="line">$ <span class="variable">$location</span>=<span class="string">"West Europe"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Create a resource group.</span></span><br><span class="line">$ New-AzureRmResourceGroup -Name myResourceGroup -Location <span class="variable">$location</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Create an App Service plan in `Free` tier.</span></span><br><span class="line">$ New-AzureRmAppServicePlan -Name <span class="variable">$webappname</span> -Location <span class="variable">$location</span> -ResourceGroupName myResourceGroup -Tier Free</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create a web app.</span></span><br><span class="line">$ New-AzureRmWebApp -Name <span class="variable">$webappname</span> -Location <span class="variable">$location</span> -AppServicePlan <span class="variable">$webappname</span> -ResourceGroupName myResourceGroup</span><br><span class="line"></span><br><span class="line"><span class="comment"># Configure GitHub deployment from your GitHub repo and deploy once.</span></span><br><span class="line">$ <span class="variable">$PropertiesObject</span> = @&#123;</span><br><span class="line">    scmType = <span class="string">"LocalGit"</span>;</span><br><span class="line">&#125;</span><br><span class="line">$ Set-AzureRmResource -PropertyObject <span class="variable">$PropertiesObject</span> -ResourceGroupName myResourceGroup -ResourceType Microsoft.Web/sites/config -ResourceName <span class="variable">$webappname</span>/web -ApiVersion <span class="number">2015</span>-<span class="number">08</span>-<span class="number">01</span> -Force</span><br><span class="line"></span><br><span class="line"><span class="comment"># Get app-level deployment credentials</span></span><br><span class="line">$ <span class="variable">$xml</span> = (Get-AzureRmWebAppPublishingProfile -Name <span class="variable">$webappname</span> -ResourceGroupName myResourceGroup -OutputFile null)</span><br><span class="line">$ <span class="variable">$username</span> = <span class="variable">$xml</span>.SelectNodes(<span class="string">"//publishProfile[@publishMethod=`"MSDeploy`"]/@userName"</span>).value</span><br><span class="line">$ <span class="variable">$password</span> = <span class="variable">$xml</span>.SelectNodes(<span class="string">"//publishProfile[@publishMethod=`"MSDeploy`"]/@userPWD"</span>).value</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add the Azure remote to your local Git respository and push your code</span></span><br><span class="line"><span class="comment">#### This method saves your password in the git remote. You can use a Git credential manager to secure your password instead.</span></span><br><span class="line">$ git remote add azure <span class="string">"https://$&#123;username&#125;:<span class="variable">$password</span>@<span class="variable">$webappname</span>.scm.azurewebsites.net"</span></span><br><span class="line">$ git push azure master</span><br></pre></td></tr></table></figure>
<h3><span id="azure-cli-20">Azure CLI 2.0</span></h3><p>Create VM.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ az group create -n MyRg -l WestUS</span><br><span class="line">$ az vm create -n MyVm -g MyRg --image UbuntuLTS</span><br></pre></td></tr></table></figure>
<p>Create and deploy web app.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ az group create -n MyRg -l WestUS</span><br><span class="line">$ az appservice plan create -n MyWebAppPlan -g MyRg</span><br><span class="line">$ az appservice web create -n MyWebApp -g MyRg -p MyWebAppPlan</span><br><span class="line">$ url=$(az appservice web <span class="built_in">source</span>-control config-local-git --name <span class="variable">$webappname</span> --resource-group myResourceGroup --query url --output tsv)</span><br><span class="line">$ git remote add azure <span class="variable">$url</span></span><br><span class="line">$ git push azure master</span><br></pre></td></tr></table></figure>
<h3><span id="gcloud">GCloud</span></h3><p>Create a VM.</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ config = New-GceInstanceConfig <span class="string">"webserver-1"</span> -MachineType <span class="string">"n1-standard-4"</span> -DiskImage (Get-GceImage -Family <span class="string">"windows-2012-r2"</span>)</span><br><span class="line">$ config | Add-GceInstance -Project MyRg -Zone <span class="string">"us-central1-b"</span></span><br></pre></td></tr></table></figure>
<p>No good web app story for PowerShell.</p>
<h3><span id="aws">AWS</span></h3><p>Create a VM.</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ New-EC2Instance -ImageId ami-c49c0dac -MinCount <span class="number">1</span> -MaxCount <span class="number">1</span> -KeyName myPSKeyPair -SecurityGroups myPSSecurityGroup -InstanceType t1.micro</span><br></pre></td></tr></table></figure>
<p>No good web app story for PowerShell.</p>
<h3><span id="heroku">Heroku</span></h3><p>Create a web app.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ heroku create</span><br><span class="line"></span><br><span class="line">Creating falling-wind-1624... <span class="keyword">done</span>, stack is cedar-14</span><br><span class="line">http://falling-wind-1624.herokuapp.com/ | https://git.heroku.com/falling-wind-1624.git</span><br><span class="line">Git remote heroku added</span><br><span class="line"></span><br><span class="line">$ git push heroku master</span><br></pre></td></tr></table></figure>
<h3><span id="zeit-now">Zeit Now</span></h3><p>Create a web app.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$ now</span><br><span class="line"></span><br><span class="line">&gt; Deploying ~/OneDrive/Projects/simpleStaticSiteTest</span><br><span class="line">&gt; Using Node.js 7.7.3 (default)</span><br><span class="line">&gt; Ready! https://simplestaticsitetest-vredymcymy.now.sh (copied to clipboard) [1s]</span><br><span class="line">&gt; Initializing…</span><br><span class="line">&gt; Building</span><br><span class="line">&gt; ▲ npm install</span><br><span class="line">&gt; ⧗ Installing:</span><br><span class="line">&gt;  ‣ serve@5.0.4</span><br><span class="line">&gt; ✓ Installed 178 modules [9s]</span><br><span class="line">&gt; ▲ npm start</span><br><span class="line">&gt; &gt; simpleStaticSiteTest@ start /home/nowuser/src</span><br><span class="line">&gt; &gt; NODE_ENV=<span class="string">'production'</span> serve ./content</span><br><span class="line">&gt; Deployment complete!</span><br></pre></td></tr></table></figure>
<h2><span id="proposed-areas-of-improvement">Proposed Areas of Improvement</span></h2><p>These areas of improvements were selected based on key differentiators in competing products.  For example, Azure CLI 2.0 has made a point of basing commands on <em>scenarios</em> rather than <em>API surface area</em>; in addition, they have chosen a number of smart defaults which make “getting started” scenarios easier for end uers.</p>
<p>The team came up with some key scenarios for design improvements.</p>
<p><img src="index/PS_Experiment_Discussion.jpg" alt=""></p>
<h3><span id="core-improvements">Core Improvements</span></h3><p>The subsequent improvements are generally regarded as “common sense”, and very little experimentation is needed to move forward in implementing these updates.</p>
<h3><span id="scenario-based-cmdlets">Scenario-based Cmdlets</span></h3><p><strong>All</strong> cmdlets should be designed around scenarios, not the Azure REST service.</p>
<h4><span id="shorter-names">Shorter Names</span></h4><p>This includes the names of cmdlets (e.g., <code>New-AzureRmVM</code> =&gt; <code>New-AzVm</code>) and the names of parameters (e.g., <code>-ResourceGroupName</code> =&gt; <code>-Rg</code>).  <strong>To ensure compatibility, and reduce breaking changes, new cmdlets should have aliases to the “old” cmdlets; in addition, they should share <em>backwards compatible</em> parameter sets.</strong></p>
<h4><span id="smart-defaults">Smart Defaults</span></h4><p>We will explore defaulting almost everything.  Popular defaults in competing products:</p>
<ul>
<li>Resource Group.</li>
<li>Location.</li>
<li>Dependent resources.</li>
</ul>
<h3><span id="experimental-improvements">Experimental Improvements</span></h3><p>The subsequent improvements present several significant paradigm shifts which the team will validate and improve upon via experimentation.</p>
<h4><span id="simple-types">Simple types</span></h4><p>Create scenarios should move away from complex types and config objects.  For example, the current “create VM” scenario requires the user to set up lots of objects that could be simplified down to one or two parameters.</p>
<h4><span id="just-do-it">“Just Do It”</span></h4><p>All create scenarios implementing “just do it” would have _no_ required parameters: all necessary information would be chosen by Azure PowerShell in an opinionated fashion.</p>
<h4><span id="gray-parameters">Gray Parameters</span></h4><p>In many cases, some parameters could be “gray” or semi-optional.  That is, if the parameter is not specified, the user is asked if we should generate the parameter for them.  For example, resource group is required for almost all <em>create</em> scenarios; however, users often want to create a resource without much concern for a specific group (especially during REPL use).  As such, resource group would be a “gray” parameter that is provisioned for the user with a random name if they choose to leave it off.</p>
<p>It also makes sense for gray parameters to infer a value based on context with the user’s consent.  For example, if the user has used a certain resource group for the last few cmdlets, it may make sense to have the gray parameter suggest the most recently used resource group (as opposed to recommending that the user create a new one).</p>
<h4><span id="-auto-switch"><code>-Auto</code> Switch</span></h4><p>This is an alternative posited in response to the fact that “gray” parameters are equivalent to the oxymoronic phrase “required parameter with a default”.  In this case, <code>New-AzVm</code> would normally require that <code>-Name</code>, <code>-Image</code>, and <code>-Rg</code> be provided.  The <code>-Auto</code> switch would provide an “opt-in” way for users to <em>default all the things</em> while maintaining the integrity of required parameters in the mainline path.</p>
<h4><span id="feature-specific-switches">Feature-Specific Switches</span></h4><p>This would be similar to <code>-Auto</code>, but would be meant for specific scenarios.  For example, the “Create web app” scenario might have a <code>-Git</code> or <code>-AddRemote</code> switch which would automatically add an “azure” remote to an existing git repository.</p>
<h4><span id="settable-defaults">Settable Defaults</span></h4><p>Users should have the ability to default certain ubiquitous parameters like <code>-ResourceGroupName</code> and <code>-Location</code>.</p>
<h4><span id="size-defaults">Size Defaults</span></h4><p>Resource “sizes” can be confusing to users since many RPs use different names (e.g., “Standard_DS1_v2” or “S1”); however, it may be asserted that users care most about cost.  With this in mind, it may make sense to define “universal” sizes.  For example, it may make sense to provide t-shirt sizes that follow a price structure.</p>
<ul>
<li>XS: under $10/month.</li>
<li>S: under $30/month.</li>
<li>M: under $50/month.</li>
<li>L: under $100/month.</li>
<li>XL: udner $200/month.</li>
</ul>
<p>Using these size, a user can let Azure PowerShell choose the <em>best option</em> based on the resource they need and the budget.  Users, however, could still specifiy a specific size if they so chose.</p>
<p>This could also be achieved by, instead, giving the user the option to pass a “maximum dollar amount per month”; subsequently, Azure PowerShell would choose the best fit at the particular price point.</p>
<h4><span id="output-format">Output Format</span></h4><p>Azure PowerShell currently returns <code>PSObject</code>s (in general), and there is normally very little console output.  However, many of the proposed designs make smart decisions on behalf of the user.  Despite the fact that console output is not a core paradigm of PowerShell, Azure PowerShell may need to display some information to the user regarding defaults, etc.</p>
<h3><span id="other">Other</span></h3><p>Parameter types:</p>
<ul>
<li>Required: e.g., name.</li>
<li>Gray: e.g., resource group.</li>
<li>Optional: e.g., VM size.</li>
</ul>
<p>Other strategy ideas:</p>
<ul>
<li>Prompts for “gray” parameters.</li>
<li>Generate script cmdlets.</li>
<li>Better preview module support.</li>
<li>Push logic server side.</li>
<li>Rename “AzureRM” to something else (sort of goes with shorter cmdlet names).</li>
</ul>
<h2><span id="killer-demos">Killer Demos</span></h2><h3><span id="create-vm">Create VM</span></h3><p>In this sample, we automate all choices for the user without any prompting.</p>
<h4><span id="with-simple-types">With Simple Types</span></h4><p>In this sample, we create the proper types out of the simple types that the user passes.  For example, the <code>-AddressPrefix</code> parameter results in a new VNET with subnet of the specified address prefix.</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">$ Login-AzAccount</span><br><span class="line">$ New-AzVm -Name MyVm -ResourceGroup MyRg -Image WinServer2016 `</span><br><span class="line">  -OpenPorts <span class="number">3389</span>,<span class="number">5985</span>,<span class="number">80</span> -AddressPrefix <span class="number">192.168</span>.<span class="number">1.0</span>/<span class="number">24</span></span><br><span class="line"></span><br><span class="line">Name: MyVm.</span><br><span class="line">Resource Group: MyRg.</span><br><span class="line">Image: WinServer2016.</span><br><span class="line">NIC: NicName.</span><br><span class="line">NSG: NSGName.</span><br><span class="line">  NSG Rule: Open (<span class="number">3389</span>).</span><br><span class="line">  NSG Rule: Open (<span class="number">5985</span>).</span><br><span class="line">  NSG Rule: Open (<span class="number">80</span>).</span><br><span class="line">  NSG Rule: Closed, all.</span><br><span class="line">Public IP: <span class="number">21.32</span>.<span class="number">43.54</span></span><br><span class="line">Size: Standard_DS1_v2</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<h4><span id="with-just-do-it">With “Just Do It”</span></h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ Login-AzAccount</span><br><span class="line">$ New-AzVm</span><br><span class="line"></span><br><span class="line">Name: MyVm12345.</span><br><span class="line">Resource Group: MyRg12345.</span><br><span class="line">Image: WinServer2016.</span><br><span class="line">NIC: NicName.</span><br><span class="line">NSG: NSGName.</span><br><span class="line">  NSG Rule: Open, RDP (<span class="number">3389</span>).</span><br><span class="line">  NSG Rule: Open, PSRemote (<span class="number">5985</span>).</span><br><span class="line">  NSG Rule: Closed, all.</span><br><span class="line">Public IP: <span class="number">21.32</span>.<span class="number">43.54</span></span><br><span class="line">Size: Standard_DS1_v2</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<h4><span id="with-gray-parameters">With Gray Parameters</span></h4><p>In this sample, we show the fact that resource group is a “gray” parameter.  The user has chosen to type out a new resource group name.<a name="createVmWithGray"></a></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">$ Login-AzAccount</span><br><span class="line">$ New-AzVm -Name MyVm -Image WinServer2016</span><br><span class="line"></span><br><span class="line">Resource group options:</span><br><span class="line">   [Default] MyRg12345</span><br><span class="line">   [<span class="number">1</span>] MyRg1</span><br><span class="line">   [<span class="number">2</span>] MyRg2</span><br><span class="line">Enter your selection or a new resource group (leave blank <span class="keyword">for</span> default): MyCustomRgName</span><br><span class="line"></span><br><span class="line">NIC: NicName.</span><br><span class="line">NSG: NSGName.</span><br><span class="line">  NSG Rule: Open, RDP (<span class="number">3389</span>).</span><br><span class="line">  NSG Rule: Open, PSRemote (<span class="number">5985</span>).</span><br><span class="line">  NSG Rule: Closed, all.</span><br><span class="line">Public IP: <span class="number">21.32</span>.<span class="number">43.54</span></span><br><span class="line">Size: Standard_DS1_v2.</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<h4><span id="with-auto">With <code>-Auto</code></span></h4><p>In this sample, we show an alternative to “gray” parameters with the introduction of an <code>-Auto</code> switch.</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ Login-AzAccount</span><br><span class="line">$ New-AzVm -Auto</span><br><span class="line"></span><br><span class="line">Name: MyVm12345.</span><br><span class="line">Resource group: MyRg12345.</span><br><span class="line">Image: WinServer2016.</span><br><span class="line">NIC: NicName.</span><br><span class="line">NSG: NSGName.</span><br><span class="line">  NSG Rule: Open, RDP (<span class="number">3389</span>).</span><br><span class="line">  NSG Rule: Open, PSRemote (<span class="number">5985</span>).</span><br><span class="line">  NSG Rule: Closed, all.</span><br><span class="line">Public IP: <span class="number">21.32</span>.<span class="number">43.54</span>.</span><br><span class="line">Size: Standard_DS1_v2.</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<p><code>-Auto</code> could also indicate that the user wants autogenerate the “rest” of the parameters.</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ Login-AzAccount</span><br><span class="line">$ New-AzVm -Name MyAwesomeVm -Auto</span><br><span class="line"></span><br><span class="line">Name: MyAwesomeVm.</span><br><span class="line">Resource group: MyRg12345.</span><br><span class="line">Image: WinServer2016.</span><br><span class="line">NIC: NicName.</span><br><span class="line">NSG: NSGName.</span><br><span class="line">  NSG Rule: Open, RDP (<span class="number">3389</span>).</span><br><span class="line">  NSG Rule: Open, PSRemote (<span class="number">5985</span>).</span><br><span class="line">  NSG Rule: Closed, all.</span><br><span class="line">Public IP: <span class="number">21.32</span>.<span class="number">43.54</span>.</span><br><span class="line">Size: Standard_DS1_v2.</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<h4><span id="with-settable-defaults">With Settable Defaults</span></h4><p>The user should be able to specify certain global defaults, e.g., resource group.  In this sample, we show the user what smart defaults were selected.</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ Login-Az</span><br><span class="line">$ New-AzRg MyRg | Set-AzDefaultRg</span><br><span class="line">$ New-AzVm -Name MyVm -Image WinServer2016</span><br><span class="line"></span><br><span class="line">NIC: NicName.</span><br><span class="line">NSG: NSGName.</span><br><span class="line">  NSG Rule: Open, RDP (<span class="number">3389</span>).</span><br><span class="line">  NSG Rule: Open, PSRemote (<span class="number">5985</span>).</span><br><span class="line">  NSG Rule: Closed, all.</span><br><span class="line">Public IP: <span class="number">21.32</span>.<span class="number">43.54</span>.</span><br><span class="line">Size: Standard_DS1_v2.</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<h4><span id="with-smart-defaults">With Smart Defaults</span></h4><p>The user should also expect to receive smart defaults, where applicable.  In this sample, we show the user what smart defaults were selected, including the public key from her machine for ubuntu (as well as open the proper port).</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ Login-Az</span><br><span class="line">$ New-AzRg MyRg | Set-AzDefaultRg</span><br><span class="line">$ New-AzVm -Name MyVm -Image Ubuntu</span><br><span class="line"></span><br><span class="line">Credentials: ~/.ssh/id_rsa.pub.</span><br><span class="line">NIC: NicName.</span><br><span class="line">NSG: NSGName.</span><br><span class="line">  NSG Rule: Open, SSH (<span class="number">22</span>).</span><br><span class="line">  NSG Rule: Closed, all.</span><br><span class="line">Public IP: <span class="number">21.32</span>.<span class="number">43.54</span>.</span><br><span class="line">Size: Standard_DS1_v2.</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<h4><span id="with-size-defaults">With Size Defaults</span></h4><p>The user should also expect to receive smart defaults, where applicable.  In this sample, we show the user what smart defaults were selected, including the public key from her machine for ubuntu (as well as open the proper port).</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ Login-Az</span><br><span class="line">$ New-AzRg MyRg | Set-AzDefaultRg</span><br><span class="line">$ New-AzVm -Name MyVm -Image Ubuntu -Size <span class="number">50</span></span><br><span class="line"></span><br><span class="line">Credentials: ~/.ssh/id_rsa.pub.</span><br><span class="line">NIC: NicName.</span><br><span class="line">NSG: NSGName.</span><br><span class="line">  NSG Rule: Open, SSH (<span class="number">22</span>).</span><br><span class="line">  NSG Rule: Closed, all.</span><br><span class="line">Public IP: <span class="number">21.32</span>.<span class="number">43.54</span>.</span><br><span class="line">Size: A1 (<span class="variable">$45</span> / month).</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<h4><span id="with-instructions">With Instructions</span></h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ Login-Az</span><br><span class="line">$ New-AzRg MyRg | Set-AzDefaultRg</span><br><span class="line">$ New-AzVm -Name MyVm -Image Ubuntu -Size <span class="number">50</span></span><br><span class="line"></span><br><span class="line">Connect to the VM with `ssh myvmdnslabel.centralus.cloudapp.azure.com`.</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<h3><span id="create-and-deploy-web-app">Create and Deploy Web App</span></h3><h4><span id="with-just-do-it">With “Just Do It”</span></h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">$ Login-Az</span><br><span class="line">$ New-AzWeb</span><br><span class="line"></span><br><span class="line">Name: MyWebApp12345.</span><br><span class="line">Plan: MyWebAppPlan12345.</span><br><span class="line">Resource Group: MyRg12345.</span><br><span class="line">Git repository detected, added remote <span class="string">"azure"</span>.</span><br><span class="line"></span><br><span class="line">$ git push azure master</span><br><span class="line"></span><br><span class="line">remote: Updating branch <span class="string">'master'</span>.        </span><br><span class="line">remote: Updating submodules.        </span><br><span class="line">remote: Preparing deployment <span class="keyword">for</span> commit id <span class="string">'ca1d79273a'</span>.        </span><br><span class="line">remote: Generating deployment script.        </span><br><span class="line">remote: Generating deployment script <span class="keyword">for</span> Web Site        </span><br><span class="line">remote: Generated deployment script files        </span><br><span class="line">remote: Running deployment command...        </span><br><span class="line">remote: Handling Basic Web Site deployment.        </span><br><span class="line">remote: KuduSync.NET from: <span class="string">'D:\home\site\repository'</span> to: <span class="string">'D:\home\site\wwwroot'</span>        </span><br><span class="line">remote: Deleting file: <span class="string">'hostingstart.html'</span>        </span><br><span class="line">remote: Copying file: <span class="string">'index.html'</span>        </span><br><span class="line">remote: Finished successfully.        </span><br><span class="line">remote: Running post deployment command(s)...        </span><br><span class="line">remote: Deployment successful.        </span><br><span class="line">To https://test-oytapcve.scm.azurewebsites.net</span><br><span class="line"> * [new branch]      master -&gt; master</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<h4><span id="with-gray-parameters-automatic-plan-and-git-remote-help">With Gray Parameters (Automatic Plan and Git Remote Help)</span></h4><p>Smart defaults would be chosen.  For example, a “free” plan should be the default web app plan.  In this sample, we show the fact that plan is a “gray” parameter.</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">$ Login-Az</span><br><span class="line">$ New-AzRg MyRg | Set-AzDefaultRg</span><br><span class="line">$ New-AzWeb -Name MyWebApp</span><br><span class="line"></span><br><span class="line">Plan options:</span><br><span class="line">   [Default] MyPlan12345</span><br><span class="line">   [<span class="number">1</span>] MyPlan1</span><br><span class="line">   [<span class="number">2</span>] MyPlan2</span><br><span class="line">Enter your selection or a new resource group (leave blank <span class="keyword">for</span> default): <span class="comment"># &#123;Can skip to use default.&#125;</span></span><br><span class="line"></span><br><span class="line">A git repository was detected, would you like to add this web app as a remote named <span class="string">"azure"</span> (Y/n)? Y</span><br><span class="line"></span><br><span class="line">$ git push azure master</span><br><span class="line"></span><br><span class="line">remote: Updating branch <span class="string">'master'</span>.        </span><br><span class="line">remote: Updating submodules.        </span><br><span class="line">remote: Preparing deployment <span class="keyword">for</span> commit id <span class="string">'ca1d79273a'</span>.        </span><br><span class="line">remote: Generating deployment script.        </span><br><span class="line">remote: Generating deployment script <span class="keyword">for</span> Web Site        </span><br><span class="line">remote: Generated deployment script files        </span><br><span class="line">remote: Running deployment command...        </span><br><span class="line">remote: Handling Basic Web Site deployment.        </span><br><span class="line">remote: KuduSync.NET from: <span class="string">'D:\home\site\repository'</span> to: <span class="string">'D:\home\site\wwwroot'</span>        </span><br><span class="line">remote: Deleting file: <span class="string">'hostingstart.html'</span>        </span><br><span class="line">remote: Copying file: <span class="string">'index.html'</span>        </span><br><span class="line">remote: Finished successfully.        </span><br><span class="line">remote: Running post deployment command(s)...        </span><br><span class="line">remote: Deployment successful.        </span><br><span class="line">To https://test-oytapcve.scm.azurewebsites.net</span><br><span class="line"> * [new branch]      master -&gt; master</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<h4><span id="with-auto">With <code>-Auto</code></span></h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">$ Login-Az</span><br><span class="line">$ New-AzRg MyRg | Set-AzDefaultRg</span><br><span class="line">$ New-AzWeb -Auto</span><br><span class="line"></span><br><span class="line">Name: MyWebApp12345.</span><br><span class="line">Plan: MyWebAppPlan12345.</span><br><span class="line">Git repository detected, added remote <span class="string">"azure"</span>.</span><br><span class="line"></span><br><span class="line">$ git push azure master</span><br><span class="line"></span><br><span class="line">remote: Updating branch <span class="string">'master'</span>.        </span><br><span class="line">remote: Updating submodules.        </span><br><span class="line">remote: Preparing deployment <span class="keyword">for</span> commit id <span class="string">'ca1d79273a'</span>.        </span><br><span class="line">remote: Generating deployment script.        </span><br><span class="line">remote: Generating deployment script <span class="keyword">for</span> Web Site        </span><br><span class="line">remote: Generated deployment script files        </span><br><span class="line">remote: Running deployment command...        </span><br><span class="line">remote: Handling Basic Web Site deployment.        </span><br><span class="line">remote: KuduSync.NET from: <span class="string">'D:\home\site\repository'</span> to: <span class="string">'D:\home\site\wwwroot'</span>        </span><br><span class="line">remote: Deleting file: <span class="string">'hostingstart.html'</span>        </span><br><span class="line">remote: Copying file: <span class="string">'index.html'</span>        </span><br><span class="line">remote: Finished successfully.        </span><br><span class="line">remote: Running post deployment command(s)...        </span><br><span class="line">remote: Deployment successful.        </span><br><span class="line">To https://test-oytapcve.scm.azurewebsites.net</span><br><span class="line"> * [new branch]      master -&gt; master</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<h4><span id="with-addremote">With <code>-AddRemote</code></span></h4><p>In this sample, we show optional parameters which assist in a later deploy.</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">$ Login-Az</span><br><span class="line">$ New-AzRg MyRg | Set-AzDefaultRg</span><br><span class="line">$ New-AzWeb -Name MyWebApp -Plan MyWebAppPlan -AddRemote</span><br><span class="line"></span><br><span class="line">Git repository detected, added remote <span class="string">"azure"</span>.</span><br><span class="line"></span><br><span class="line">$ git push azure master</span><br><span class="line"></span><br><span class="line">remote: Updating branch <span class="string">'master'</span>.        </span><br><span class="line">remote: Updating submodules.        </span><br><span class="line">remote: Preparing deployment <span class="keyword">for</span> commit id <span class="string">'ca1d79273a'</span>.        </span><br><span class="line">remote: Generating deployment script.        </span><br><span class="line">remote: Generating deployment script <span class="keyword">for</span> Web Site        </span><br><span class="line">remote: Generated deployment script files        </span><br><span class="line">remote: Running deployment command...        </span><br><span class="line">remote: Handling Basic Web Site deployment.        </span><br><span class="line">remote: KuduSync.NET from: <span class="string">'D:\home\site\repository'</span> to: <span class="string">'D:\home\site\wwwroot'</span>        </span><br><span class="line">remote: Deleting file: <span class="string">'hostingstart.html'</span>        </span><br><span class="line">remote: Copying file: <span class="string">'index.html'</span>        </span><br><span class="line">remote: Finished successfully.        </span><br><span class="line">remote: Running post deployment command(s)...        </span><br><span class="line">remote: Deployment successful.        </span><br><span class="line">To https://test-oytapcve.scm.azurewebsites.net</span><br><span class="line"> * [new branch]      master -&gt; master</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<h4><span id="with-improved-deploy-support">With Improved Deploy Support</span></h4><p>This sample gets the deployment endpoint (not trivial currently) and deploys.</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">$ Login-Az</span><br><span class="line">$ New-AzRg MyRg | Set-AzDefaultRg</span><br><span class="line">$ <span class="variable">$webApp</span> = New-AzWeb -Name MyWebApp -Plan MyWebAppPlan</span><br><span class="line">$ git remote add azure <span class="variable">$webapp</span>.ScmUri</span><br><span class="line">$ git push azure master</span><br><span class="line"></span><br><span class="line">remote: Updating branch <span class="string">'master'</span>.        </span><br><span class="line">remote: Updating submodules.        </span><br><span class="line">remote: Preparing deployment <span class="keyword">for</span> commit id <span class="string">'ca1d79273a'</span>.        </span><br><span class="line">remote: Generating deployment script.        </span><br><span class="line">remote: Generating deployment script <span class="keyword">for</span> Web Site        </span><br><span class="line">remote: Generated deployment script files        </span><br><span class="line">remote: Running deployment command...        </span><br><span class="line">remote: Handling Basic Web Site deployment.        </span><br><span class="line">remote: KuduSync.NET from: <span class="string">'D:\home\site\repository'</span> to: <span class="string">'D:\home\site\wwwroot'</span>        </span><br><span class="line">remote: Deleting file: <span class="string">'hostingstart.html'</span>        </span><br><span class="line">remote: Copying file: <span class="string">'index.html'</span>        </span><br><span class="line">remote: Finished successfully.        </span><br><span class="line">remote: Running post deployment command(s)...        </span><br><span class="line">remote: Deployment successful.        </span><br><span class="line">To https://test-oytapcve.scm.azurewebsites.net</span><br><span class="line"> * [new branch]      master -&gt; master</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<h4><span id="with-instructions">With Instructions</span></h4><p>This sample gets the deployment endpoint (not trivial currently) and deploys.</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ Login-Az</span><br><span class="line">$ New-AzRg MyRg | Set-AzDefaultRg</span><br><span class="line">$ <span class="variable">$webApp</span> = New-AzWeb -Name MyWebApp -Plan MyWebAppPlan</span><br><span class="line"></span><br><span class="line">Use `ScmUri` to deploy via git, GitHub or FTP.  <span class="keyword">For</span> example, you can configure a local git remote with `git remote add azure <span class="variable">$result</span>.ScmUri`.</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<h3><span id="storage-scenarios">Storage scenarios?</span></h3><h3><span id="sql-scenarios">SQL scenarios?</span></h3><h3><span id="network-scenarios">Network scenarios?</span></h3><h3><span id="acsacrcontainer-scenarios">ACS/ACR/Container scenarios?</span></h3><h3><span id="function-app-awesomeness">Function app awesomeness?</span></h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ Login-Az</span><br><span class="line">$ New-AzRg MyRg | Set-AzDefaultRg</span><br><span class="line">$ New-AzFunction -AppName MyFunctionApp -Source myFunction.js</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<h2><span id="customer-feedback">Customer Feedback</span></h2><h3><span id="concept-interviews">Concept Interviews</span></h3><p>Some of these examples were shown to customers.  We received some good feedback on these strategy ideas.<br>All of the feedback compiled was in reference to <a href="#createVmWithGray">creating a VM with gray parameters</a> versus <a href="#createVmOld">creating a VM today</a>.</p>
<h4><span id="scott-g">Scott G.</span></h4><ul>
<li>Roll out some simplifications around Create VM cmdlet by June 30.</li>
<li>Be diligent about what scenarios we chose and be vary of introducing breaking changes.</li>
<li>The “gray” parameter might be a <em>little</em> confusing…would rather just have them be required.</li>
<li>Look at CLI tutorials to get ideas for similar defaults.</li>
<li>Literally steal some of the defaults from CLI end-to-end scenarios.</li>
</ul>
<h4><span id="mark-g">Mark G.</span></h4><ul>
<li>About current script:<ul>
<li>The script as it is today is not bad: variables could be serialized.</li>
<li>Does not mind the length of the script because most of the networking entities would already be around for him to pull in.</li>
</ul>
</li>
<li>About proposed script:<ul>
<li>“This is brilliant!”</li>
<li>“Love the smart defaults.”</li>
<li>“What’s frustrating at AWS is that if you get something wrong, you just get exception…I Like the ‘guided’ experience.”</li>
<li>“Prompts should give a ‘suggested’ default that happens when you hit ENTER, but if you want to type specific name, then you can; if you want to <code>-Force</code>, you can.”</li>
<li>Stated that he hates the inconsistencies in <em>AWS cmdlets</em>.</li>
<li>Consistency across RPs should be a high priority.</li>
</ul>
</li>
</ul>
<h4><span id="lenny-s">Lenny S.</span></h4><ul>
<li>About current script:<ul>
<li>Logical defaults for most of the network setup stuff - it is great to have the capability, but this is too difficult to start up with.</li>
<li>Length of cmdlet name: tab completion makes this less interesting.</li>
<li>Doesn’t mind azure being spelled out.</li>
</ul>
</li>
<li>About proposed script:<ul>
<li>Likes default resource group.</li>
<li>Does not necessarily care about tab completion for images/location.</li>
<li>Prompts with <code>-Force</code> are a good way to balance prompting with scripting.</li>
<li>Should allow for cross-session defaulting of resource group, location, etc.</li>
</ul>
</li>
</ul>
<h4><span id="chris-d">Chris D.</span></h4><ul>
<li>About current script:<ul>
<li>“It doesn’t look terrible.”</li>
<li>“Not terribly convoluted, this is actually not that complex.”</li>
<li>Would go to books for help.</li>
<li>PowerShell does not have a good UI to obtain modules from PSGallery.</li>
<li>Getting started for PowerShell is difficult.</li>
</ul>
</li>
<li>About proposed script:<ul>
<li>“Reduced set is way better.”</li>
<li>Important to allow for fallback to “old” script for power users.</li>
<li>Json template is a good idea for creating complex objects.</li>
</ul>
</li>
</ul>
<h4><span id="jon-c">Jon C.</span></h4><ul>
<li>About current script:<ul>
<li>Immediate reaction is that this shows me the logical progression. It shows intent. Very procedural.</li>
<li>“If I am an IT Pro, this makes perfect sense.”</li>
<li>“To me, it seems awfully verbose. There’s a lot of words.”</li>
<li>“Lots of opportunities to make a mistake.”</li>
</ul>
</li>
<li>About proposed script:<ul>
<li>“I like DSC. It is declarative. I am describing the ‘what’ I want instead of ‘how’ I want.”</li>
<li>“I like the declarative nature of this…not necessarily because it is shorter.”</li>
<li>“Length of cmdlet name makes almost no difference to me.”</li>
<li>“It is declarative and more easy to read.”</li>
<li>“DSC is my best friend, and this is like that.”</li>
<li>Liked the fact that selected defaults were displayed in a “short format”.</li>
</ul>
</li>
</ul>
<h3><span id="feature-interviews">Feature Interviews</span></h3><h3><span id="hci-interviews">HCI Interviews</span></h3><h1><span id="conclusion">Conclusion</span></h1>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://blog.aaroney.com/Azure-PowerShell-Strategy/index.html" data-id="cji1frq0t002hwhysr9ie7kuh" class="article-share-link">Share</a>
      
        <a href="http://blog.aaroney.com/Azure-PowerShell-Strategy/index.html#disqus_thread" class="article-comment-link">Comments</a>
      
      
    </footer>
  </div>
  
    
  
</article>


<section id="comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>
</section>
        
          <aside id="sidebar">
  <img src="/images/self.jpg" width="200" style="margin-top: 80px;">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Built-with-Azure-Tools/">Built with Azure Tools</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/The-Supreme-Court-is-Usually-Badass/">The Supreme Court is Usually Badass</a><span class="category-list-count">6</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/azure/">azure</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/azure-cli/">azure-cli</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/csharp/">csharp</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/">docker</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/documentdb/">documentdb</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dotnet/">dotnet</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/microsoft/">microsoft</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/scotus/">scotus</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/supreme-court/">supreme court</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vscode/">vscode</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/azure/" style="font-size: 16.67px;">azure</a> <a href="/tags/azure-cli/" style="font-size: 16.67px;">azure-cli</a> <a href="/tags/csharp/" style="font-size: 16.67px;">csharp</a> <a href="/tags/docker/" style="font-size: 13.33px;">docker</a> <a href="/tags/documentdb/" style="font-size: 10px;">documentdb</a> <a href="/tags/dotnet/" style="font-size: 16.67px;">dotnet</a> <a href="/tags/microsoft/" style="font-size: 16.67px;">microsoft</a> <a href="/tags/scotus/" style="font-size: 20px;">scotus</a> <a href="/tags/supreme-court/" style="font-size: 20px;">supreme court</a> <a href="/tags/vscode/" style="font-size: 10px;">vscode</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">February 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">November 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">October 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">September 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">July 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">June 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">May 2016</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2017/05/05/Dockerize-your-Web-App/">Dockerize your Web App</a>
          </li>
        
          <li>
            <a href="/2017/02/11/Add-DocumentDB-to-your-Web-App/">Add DocumentDB to your Web App</a>
          </li>
        
          <li>
            <a href="/2017/02/03/NET-Core-Web-App-in-Azure/">Build a .NET Core Web App in Azure</a>
          </li>
        
          <li>
            <a href="/2016/11/01/Issue-7-Burwell-v-Hobby-Lobby/">Issue 7: Burwell v. Hobby Lobby</a>
          </li>
        
          <li>
            <a href="/2016/10/01/Issue-6-United-States-v-Windsor/">Issue 6: United States v. Windsor</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 Aaron Roney<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    
<script>
  var disqus_shortname = 'twitchax-blog';
  
  var disqus_url = 'http://blog.aaroney.com/Azure-PowerShell-Strategy/index.html';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>